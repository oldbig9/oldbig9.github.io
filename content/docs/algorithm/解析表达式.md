---
weight: 100
title: "解析表达式"
description: ""
icon: "article"
date: "2025-10-18T19:49:24+08:00"
lastmod: "2025-10-18T19:49:24+08:00"
draft: true
toc: true
tags:
- 算法
- 栈
categories:
- tech
series:
---

## 题目描述

假设A表示乘法，B表示加法，给定一个表达式，计算出表达式的结果。
例如A(1,2) = 1 * 2 = 2
B(1,2) = 1 + 2 = 3
A(B(1,2),2) = A(3,2) = 3 * 2 = 6

## 解析思路

本题可以使用栈结构来进行解题，遍历表达式，遇到)时，对栈进行出栈操作，查找最近匹配的(，计算结果并将结果入栈

```go
package main

import (
	"fmt"
	"strconv"
)

func main() {
	exp := "A(A(1,2),B(1,2))"
	fmt.Println(parseExp(exp))
}

// A表示乘，如A(1,2)表示1x2=2
// B表示加，如B(1,2)表示1+2=3
func parseExp(exp string) int {
	stack := make([]rune, 0, len(exp))
	for _, v := range exp {
		// )出栈找到最近的(进行计算并入栈
		if v == ')' {
			isarg2 := true
			arg1 := make([]rune, 0)
			arg2 := make([]rune, 0)
			arg2Val := 0
			arg1Val := 0
			val := 0
			for tail := len(stack) - 1; tail >= 0; tail-- {
				if stack[tail] == ',' {
					arg2Val, _ = strconv.Atoi(string(arg2))
					isarg2 = false
				} else if stack[tail] == '(' {
					// 计算参数1
					arg1Val, _ = strconv.Atoi(string(arg1))
				} else if stack[tail] == 'A' {
					val = arg1Val * arg2Val
					stack = stack[:tail]
					break
				} else if stack[tail] == 'B' {
					val = arg1Val + arg2Val
					stack = stack[:tail]
					break
				} else if isarg2 {
					// 出栈
					arg2 = append(arg2, stack[tail])
				} else {
					arg1 = append(arg1, stack[tail])
				}
			}
			stack = append(stack, []rune(strconv.Itoa(val))...)
		} else {
			// 入栈
			stack = append(stack, v)
		}
	}

	res, _ := strconv.Atoi(string(stack))
	return res
}
```